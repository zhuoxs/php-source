{extend name="common/edit2" /}
{block name="content"}
<blockquote class="layui-elem-quote">上下线设置</blockquote>
<div class="layui-form-item">
    <label class="layui-form-label">成为下线条件</label>
    <div class="layui-input-block">
        <input type="radio" name="distribution_relation" value="0" title="首次点击分享链接" {$info.distribution_relation ? "" : "checked"}>
        <input type="radio" name="distribution_relation" value="1" title="首次下单" {$info.distribution_relation == 1 ? "checked" :""}>
        <input type="radio" name="distribution_relation" value="2" title="首次付款" {$info.distribution_relation == 2 ? "checked" :""}>
    </div>
</div>
<blockquote class="layui-elem-quote">分销资格设置</blockquote>
<div class="layui-form-item">
    <label class="layui-form-label">分销申请审核</label>
    <div class="layui-input-block">
        <input type="radio" name="distribution_apply" value="0" title="不需要" {$info.distribution_apply ? "" : "checked"}>
        <input type="radio" name="distribution_apply" value="1" title="需要" {$info.distribution_apply == 1 ? "checked" :""}>
    </div>
</div>
<!--<blockquote class="layui-elem-quote">分销申请设置</blockquote>-->
<!--<div class="layui-form-item">-->
    <!--<label class="layui-form-label">分销后台申请提示背景图</label>-->
    <!--<div class="layui-input-block">-->
        <!--{php1}echo tpl_form_field_image('distribution_apply_bgm', isset($info['distribution_apply_bgm'])?$info['distribution_apply_bgm']:'','/web/resource/images/nopic.jpg');{/php}-->
        <!--<div class="layui-form-mid layui-word-aux">-->
            <!--<p>建议尺寸：750*1727</p>-->
            <!--<p>距顶部 782 位置保留 160 高度的空白，用于放置申请按钮</p>-->
        <!--</div>-->
    <!--</div>-->
<!--</div>-->
<blockquote class="layui-elem-quote">协议设置</blockquote>
<div class="layui-form-item">
    <label class="layui-form-label">注册时是否显示</label>
    <div class="layui-input-block">
        <input type="radio" name="distribution_apply_show" value="0" title="隐藏" {$info.distribution_apply_show ? "" : "checked"}>
        <input type="radio" name="distribution_apply_show" value="1" title="显示" {$info.distribution_apply_show == 1 ? "checked" :""}>
    </div>
</div>
<div class="layui-form-item">
    <label class="layui-form-label">协议标题</label>
    <div class="layui-input-block">
        <input autocomplete="off" type="text" name="distribution_apply_title" placeholder="请输入标题" class="layui-input" value="{$info.distribution_apply_title??''}">
    </div>
</div>
<div class="layui-form-item">
    <label class="layui-form-label">协议内容</label>
    <div class="layui-input-block">
        {php}echo tpl_ueditor('distribution_apply_agreement', $info['distribution_apply_agreement']);{/php}
    </div>
</div>
<blockquote class="layui-elem-quote">推广设置</blockquote>
<div class="layui-form-item">
    <label class="layui-form-label">邀请语</label>
    <div class="layui-input-block">
        <input autocomplete="off" type="text" name="distribution_share_msg" placeholder="请输入邀请语" class="layui-input" value="{$info.distribution_share_msg??''}">
    </div>
</div>
<div class="layui-form-item">
    <label class="layui-form-label">推广标题</label>
    <div class="layui-input-block">
        <input autocomplete="off" type="text" name="distribution_share_title" placeholder="请输入标题" class="layui-input" value="{$info.distribution_share_title??''}">
    </div>
</div>
<div class="layui-form-item">
    <label class="layui-form-label">推广封面图</label>
    <div class="layui-input-block">
        {php}echo tpl_form_field_image('distribution_share_banner', isset($info['distribution_share_banner'])?$info['distribution_share_banner']:'','/web/resource/images/nopic.jpg');{/php}
        <div class="layui-form-mid layui-word-aux">建议尺寸：600*460</div>
    </div>
</div>
<blockquote class="layui-elem-quote">层级设置</blockquote>

<div class="layui-form-item">
    <label class="layui-form-label">分销层级</label>
    <div class="layui-input-block">
        <input type="radio" lay-filter="distribution_level"  name="distribution_level" value="0" title="不开启" {$info.distribution_level ? "" : "checked"}>
        <input type="radio" lay-filter="distribution_level"  name="distribution_level" value="1" title="一级分销" {$info.distribution_level == 1 ? "checked" :""}>
        <input type="radio" lay-filter="distribution_level"  name="distribution_level" value="2" title="二级分销" {$info.distribution_level == 2 ? "checked" :""}>
        <input type="radio" lay-filter="distribution_level"  name="distribution_level" value="3" title="三级分销" {$info.distribution_level == 3 ? "checked" :""}>
    </div>
</div>
<div class="layui-form-item level level1 level2 level3" style="display: none;">
    <label class="layui-form-label">分销内购</label>
    <div class="layui-input-block">
        <input type="radio" name="distribution_self" value="0" title="关闭" {$info.distribution_self ? "" : "checked"}>
        <input type="radio" name="distribution_self" value="1" title="开启" {$info.distribution_self == 1 ? "checked" :""}>
        <div style="float: none;" class="layui-form-mid layui-word-aux">开启分销内购，分销商自己购买商品，享受一级佣金，上级享受二级佣金，上上级享受三级佣金</div>
    </div>
</div>
<div class="layui-form-item level level1 level2 level3">
    <label class="layui-form-label">分佣类型</label>
    <div class="layui-input-block">
        <input type="radio" name="distribution_draw_type" lay-filter="distribution_draw_type" value="1" title="比率" {$info.distribution_draw_type == 2? "" : "checked"}>
        <input type="radio" name="distribution_draw_type" lay-filter="distribution_draw_type" value="2" title="固定金额" {$info.distribution_draw_type == 2 ? "checked" :""}>
    </div>
</div>
<div class="layui-form-item level level1 level2 level3" style="display: none;">
    <label class="layui-form-label distribution_draw_type1">一级分佣比例</label>
    <div class="layui-input-block distribution_draw_type1">
        <input autocomplete="off" type="text" name="distribution_rate_level1" placeholder="请输入比例" class="layui-input" value="{$info.distribution_rate_level1??''}">
        <div class="layui-form-mid layui-word-aux">%</div>
    </div>

    <label class="layui-form-label distribution_draw_type2">一级分佣金额</label>
    <div class="layui-input-block distribution_draw_type2">
        <input autocomplete="off" type="text" name="distribution_money_level1" placeholder="请输入金额" class="layui-input" value="{$info.distribution_money_level1??''}">
    </div>
</div>
<div class="layui-form-item level level2 level3" style="display: none;">
    <label class="layui-form-label distribution_draw_type1">二级分佣比例</label>
    <div class="layui-input-block distribution_draw_type1">
        <input autocomplete="off" type="text" name="distribution_rate_level2" placeholder="请输入比例" class="layui-input" value="{$info.distribution_rate_level2??''}">
        <div class="layui-form-mid layui-word-aux">%</div>
    </div>

    <label class="layui-form-label distribution_draw_type2">二级分佣金额</label>
    <div class="layui-input-block distribution_draw_type2">
        <input autocomplete="off" type="text" name="distribution_money_level2" placeholder="请输入金额" class="layui-input" value="{$info.distribution_money_level2??''}">
    </div>
</div>
<div class="layui-form-item level level3" style="display: none;">
    <label class="layui-form-label distribution_draw_type1">三级分佣比例</label>
    <div class="layui-input-block distribution_draw_type1">
        <input autocomplete="off" type="text" name="distribution_rate_level3" placeholder="请输入比例" class="layui-input" value="{$info.distribution_rate_level3??''}">
        <div class="layui-form-mid layui-word-aux">%</div>
    </div>

    <label class="layui-form-label distribution_draw_type2">三级分佣金额</label>
    <div class="layui-input-block distribution_draw_type2">
        <input autocomplete="off" type="text" name="distribution_money_level3" placeholder="请输入金额" class="layui-input" value="{$info.distribution_money_level3??''}">
    </div>
</div>
<script>
    layui.use('form',function () {
        var form = layui.form;
        form.on('radio(distribution_level)', function(data){
            change(data.value);
        });
        var type = $('input[name="distribution_draw_type"]:checked').val();
        updateType(type)

        form.on('radio(distribution_draw_type)', function (data) {
            var type = data.value;
            updateType(type)
        });
        function updateType(type) {
            if (type == 1) {
                $('.distribution_draw_type2').hide();
                $('.distribution_draw_type1').show();
            } else {
                $('.distribution_draw_type1').hide();
                $('.distribution_draw_type2').show();
            }
        }
    })
    function change(level) {
        $('.level').hide();
        $('.level'+level).show();
    }
    change({$level});
</script>
{/block}

{block name="form_submit"}
// 新增界面、保存、取消事件
form.on('submit', function(data){
if(!$(data.elem).is('button')){
return false;
}
var data = data.field;
var url = "{:adminurl('setting_save')}";
$.post(url,data,function(res){
if (typeof res == 'string'){
res = $.parseJSON(res);
}
if (res.code == 0) {
layer.msg('保存成功',{icon: 6,anim: 6});
location.reload();
}else{
layer.msg(res.msg,{icon: 5,anim: 6});
}
});
return false; //阻止表单跳转。如果需要表单跳转，去掉这段即可。
});
{/block}