<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title></title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <link rel="stylesheet" href="../../../addons/{$module_name}/images/layuiadmin/layui/css/layui.css" media="all">
    <link rel="stylesheet" href="../../../addons/{$module_name}/images/layuiadmin/style/admin.css" media="all">
    <link rel="stylesheet" href="../../../addons/{$module_name}/images/css/main.css" media="all">
    <!--<script src="../../../addons/{$module_name}/images/js/jquery.min.js"></script>-->


    <link href="./resource/css/bootstrap.min.css?v=20170426" rel="stylesheet">
    <link href="./resource/css/common.css?v=20170426" rel="stylesheet">
    <script type="text/javascript" src="./resource/js/lib/jquery-1.11.1.min.js"></script>
    <script type="text/javascript" src="./resource/js/lib/bootstrap.min.js"></script>
    <script type="text/javascript" src="./resource/js/app/util.js?v=20170426"></script>
    <script type="text/javascript" src="./resource/js/app/common.min.js?v=20170426"></script>
    <script type="text/javascript" src="./resource/js/require.js?v=20170426"></script>
</head>
<body>


<div class="layui-fluid">
    <div class="layui-row layui-col-space15">
        <div class="layui-col-md12">
            <div class="layui-card">
                <div class="layui-card-header">万能通知</div>

                <div class="layui-card-body">

                    <div class="layui-tab layui-tab-card">

                        <ul class="layui-tab-title">
                            <li class="layui-this">服务通知</li>
                            <li>企业微信通知</li>
                            <li>公众号通知</li>
                        </ul>

                        <div class="layui-tab-content">
                            <!--服务通知-->
                            <div class="layui-tab-item layui-show">

                                <form class="layui-form" action="" onsubmit="return false">

                                    <div class="layui-form-item">
                                        <label class="layui-form-label">模板ID
                                        </label>
                                        <div class="layui-input-block">
                                            <input type="text" name="mini_template_id" placeholder="请输入" autocomplete="off" class="layui-input" value="{$info['mini_template_id']}">
                                            <!--<a href="https://www.kancloud.cn/longbing/aicard/825971" target="_blank">-->
                                            <span class="span-remark">服务通知模板ID, 用于给客户发送服务通知, 公众号通知未启用则员工也采用服务通知，有问题请联系技术</span>
                                            <!--</a>-->
                                        </div>
                                    </div>

                                    <!--<div class="layui-form-item">-->
                                        <!--<label class="layui-form-label">启用</label>-->
                                        <!--<div class="layui-input-block">-->
                                            <!--{if $info['notice_switch'] == 1 }-->
                                            <!--<input type="radio" name="notice_switch" value="0" title="启用">-->
                                            <!--<input type="radio" name="notice_switch" value="1" title="关闭" checked>-->
                                            <!--{else}-->
                                            <!--<input type="radio" name="notice_switch" value="0" title="启用" checked>-->
                                            <!--<input type="radio" name="notice_switch" value="1" title="关闭">-->
                                            <!--{/if}-->
                                        <!--</div>-->
                                    <!--</div>-->

                                    <div class="layui-form-item">
                                        <div class="layui-input-block">
                                            <button class="layui-btn" type="button" lay-submit
                                                    lay-filter="syncMsg">自动同步服务通知</button>
                                            <span class="span-remark">自动同步会在你的小程序创建一个个人模版，并会把你的模板ID保存下来，已经可以正常使用无需重复同步</span>
                                        </div>
                                    </div>

                                    <div class="layui-form-item">
                                        <div class="layui-input-block">
                                            <button class="layui-btn" lay-submit lay-filter="formSub1">立即提交</button>
                                            <button type="reset" class="layui-btn layui-btn-primary">重置</button>
                                        </div>
                                    </div>

                                </form>

                            </div>

                            <!--企业微信通知-->
                            <div class="layui-tab-item">

                                <form class="layui-form" action="" onsubmit="return false">

                                    <div class="layui-form-item">
                                        <label class="layui-form-label">企业微信ID</label>
                                        <div class="layui-input-block">
                                            <input type="text" name="corpid" placeholder="" autocomplete="off" class="layui-input" value="{$info['corpid']}">
                                            <!--<a href="https://work.weixin.qq.com/api/doc#90000/90135/90665/corpid" target="_blank">-->
                                                <span class="span-remark">每个企业都拥有唯一的corpid，点击查看如何获取，有问题请联系技术</span>
                                            <!--</a>-->
                                        </div>
                                    </div>

                                    <div class="layui-form-item">
                                        <label class="layui-form-label">应用密匙</label>
                                        <div class="layui-input-block">
                                            <input type="text" name="corpsecret" placeholder="" autocomplete="off" class="layui-input" value="{$info['corpsecret']}">
                                            <!--<a href="https://work.weixin.qq.com/api/doc#90000/90135/90665/secret" target="_blank">-->
                                                <span class="span-remark">在企业微信中，将自己的小程序添加到应用就可以查看应用密匙，点击查看如何获取，有问题请联系技术</span>
                                            <!--</a>-->
                                        </div>
                                    </div>

                                    <div class="layui-form-item">
                                        <label class="layui-form-label">企业应用ID</label>
                                        <div class="layui-input-block">
                                            <input type="text" name="agentid" placeholder="" autocomplete="off" class="layui-input" value="{$info['agentid']}">
                                            <!--<a href="https://work.weixin.qq.com/api/doc#90000/90135/90665/agentid" target="_blank">-->
                                                <span class="span-remark">企业应用ID，在企业微信应用与小程序中查看，点击查看如何获取，有问题请联系技术</span>
                                            <!--</a>-->
                                        </div>
                                    </div>

                                    <div class="layui-form-item">
                                        <label class="layui-form-label">启用</label>
                                        <div class="layui-input-block">
                                            {if $info['notice_switch'] == 2 }
                                            <input type="radio" name="notice_switch" value="2" title="启用" checked>
                                            <input type="radio" name="notice_switch" value="1" title="公众号">
                                            <input type="radio" name="notice_switch" value="0" title="关闭">
                                            {elseif $info['notice_switch'] == 1 }
                                            <input type="radio" name="notice_switch" value="2" title="启用">
                                            <input type="radio" name="notice_switch" value="1" title="公众号" checked>
                                            <input type="radio" name="notice_switch" value="0" title="关闭">
                                            {else}
                                            <input type="radio" name="notice_switch" value="2" title="启用">
                                            <input type="radio" name="notice_switch" value="1" title="公众号">
                                            <input type="radio" name="notice_switch" value="0" title="关闭"checked>
                                            {/if}
                                            <span class="span-remark">启用企业微信通知后员工将采用企业微信通知，员工需要在编辑名片信息处填写自己的企业微信账号</span>
                                        </div>
                                    </div>

                                    <div class="layui-form-item">
                                        <div class="layui-input-block">
                                            <button class="layui-btn" lay-submit lay-filter="formSub2">立即提交</button>
                                            <button type="reset" class="layui-btn layui-btn-primary">重置</button>
                                        </div>
                                    </div>

                                </form>

                            </div>

                            <!--公众号通知-->
                            <div class="layui-tab-item">

                                <form class="layui-form" action="" onsubmit="return false">

                                    <div class="layui-form-item">
                                        <label class="layui-form-label">appid
                                        </label>
                                        <div class="layui-input-block">
                                            <input type="text" name="wx_appid" placeholder="请输入" autocomplete="off" class="layui-input" value="{$info['wx_appid']}">
                                            <span class="span-remark">与这个小程序关联的微信公众号的appid，注意不是小程序的appid，有问题请联系技术</span>
                                        </div>
                                    </div>

                                    <div class="layui-form-item">
                                        <label class="layui-form-label">模板ID
                                        </label>
                                        <div class="layui-input-block">
                                            <input type="text" name="wx_tplid" placeholder="请输入" autocomplete="off" class="layui-input" value="{$info['wx_tplid']}">
                                            <!--<a href="https://www.kancloud.cn/longbing/aicard/825972" target="_blank">-->
                                            <span class="span-remark">与这个小程序关联的微信公众号里面添加的模板消息ID，与服务通知的模板ID类似。如果开启了公众号通知，则会优先采用公众号通知，没有关注公众号则会采用服务通知</span>
                                            <!--</a>-->
                                        </div>
                                    </div>

                                    <div class="layui-form-item">
                                        <label class="layui-form-label">启用</label>
                                        <div class="layui-input-block">
                                            {if $info['notice_switch'] == 1 }
                                            <input type="radio" name="notice_switch" value="1" title="启用" checked>
                                            <input type="radio" name="notice_switch" value="2" title="企业微信">
                                            <input type="radio" name="notice_switch" value="0" title="关闭">
                                            {elseif $info['notice_switch'] == 2 }
                                            <input type="radio" name="notice_switch" value="1" title="启用">
                                            <input type="radio" name="notice_switch" value="2" title="企业微信" checked>
                                            <input type="radio" name="notice_switch" value="0" title="关闭">
                                            {else}
                                            <input type="radio" name="notice_switch" value="1" title="启用">
                                            <input type="radio" name="notice_switch" value="2" title="企业微信">
                                            <input type="radio" name="notice_switch" value="0" title="关闭"checked>
                                            {/if}
                                        </div>
                                    </div>

                                    <div class="layui-form-item">
                                        <div class="layui-input-block">
                                            <button class="layui-btn" lay-submit lay-filter="formSub2">立即提交</button>
                                            <button type="reset" class="layui-btn layui-btn-primary">重置</button>
                                        </div>
                                    </div>

                                </form>

                            </div>

                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>
</div>


{template 'common/footer'}

<style>
    .friend-link{
        text-align: center;
    }
    .copyright{
        text-align: center;
        padding-bottom: 20px;
    }
</style>

<script src="../../../addons/{$module_name}/images/layuiadmin/layui/layui.js"></script>
<script>

    layui.use(['layer', 'form', 'element'], function () {
        var layer = layui.layer
            , form = layui.form
            , element = layui.element

        form.on('submit(formSub1)', function(data){

            var formData = data.field;
            layer.load();

            var url = "{php echo $this->createWebUrl('manage/message')}";

            var id = '{$id}';
            var data = {
                action: 'edit',
                formData: formData
            };
            if (id > 0) {
                data.id = id;
            }
            postData(url, data);

            return false;
        });

        form.on('submit(formSub2)', function(data){
            var formData = data.field;
            layer.load();

            var url = "{php echo $this->createWebUrl('manage/message')}";

            var id = '{$id}';
            var data = {
                action: 'edit',
                formData: formData
            };
            if (id > 0) {
                data.id = id;
            }
            postData(url, data);

            return false;
        });

        form.on('submit(syncMsg)', function(data){
            layer.load();

            var url = "{php echo $this->createWebUrl('manage/message')}";

            var id = '{$id}';
            var data = {
                action: 'sync',
            };
            if (id > 0) {
                data.id = id;
            }
            postData(url, data);

            return false;
        });

    });

    function goBackUrl ()
    {
        history.back();
    }
</script>
<script src="../../../addons/{$module_name}/images/js/main.js"></script>
</body>
</html>